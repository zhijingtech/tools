# tools

## enum2func

*enum2func* generates functions for enum.

For example, we define an enum as follow:
```go
type ctxKey byte

//go:generate enum2func -c ./enum2func.yml
const (
	ctxKeyCompanyInfo ctxKey = iota // 公司信息
	ctxKeyEnvInfo                   // 环境信息
	ctxKeyAppInfo                   // 应用信息
	ctxKeyUserInfo                  // 用户信息
)
```

And configure enum2func.yml as follow:
```yaml
tasks:
    - type: ctxKey
      input: ./context.go
      output: ""
      trimPrefix: "ctxKey"
      package: ""
      imports:
        - '"context"'
        - ''
        - 'v1 "gitlab.szzhijing.com/quanbu/apaas/api/v1"'
      lines:
        - ''
        - 'func (ctx *Context) Get{{.TrimmedName}}() (*{{.TrimmedName}}, error) {'
        - '  info, ok := ctx.Value({{.Name}}).(*{{.TrimmedName}})'
        - '  if !ok {'
        - '    return nil, v1.ErrorNotFound("{{.TrimmedName}} not found")'
        - '  }'
        - '  return info, nil'
        - '}'
        - ''
        - 'func (ctx *Context) Set{{.TrimmedName}}(info *{{.TrimmedName}})  {'
        - '	ctx.Context = context.WithValue(ctx.Context, {{.Name}}, info)'
        - '}'
```

When run `go generate ./...`, the following code will be genrated in ctxkey_func_gen.go：

```go
// Code generated by "enum2func"; !!!DO NOT EDIT!!!
package biz

import (
	"context"

	v1 "gitlab.szzhijing.com/quanbu/apaas/api/v1"
)

func (ctx *Context) GetCompanyInfo() (*CompanyInfo, error) {
	info, ok := ctx.Value(ctxKeyCompanyInfo).(*CompanyInfo)
	if !ok {
		return nil, v1.ErrorNotFound("CompanyInfo not found")
	}
	return info, nil
}

func (ctx *Context) SetCompanyInfo(info *CompanyInfo) {
	ctx.Context = context.WithValue(ctx.Context, ctxKeyCompanyInfo, info)
}

func (ctx *Context) GetEnvInfo() (*EnvInfo, error) {
	info, ok := ctx.Value(ctxKeyEnvInfo).(*EnvInfo)
	if !ok {
		return nil, v1.ErrorNotFound("EnvInfo not found")
	}
	return info, nil
}

func (ctx *Context) SetEnvInfo(info *EnvInfo) {
	ctx.Context = context.WithValue(ctx.Context, ctxKeyEnvInfo, info)
}

func (ctx *Context) GetAppInfo() (*AppInfo, error) {
	info, ok := ctx.Value(ctxKeyAppInfo).(*AppInfo)
	if !ok {
		return nil, v1.ErrorNotFound("AppInfo not found")
	}
	return info, nil
}

func (ctx *Context) SetAppInfo(info *AppInfo) {
	ctx.Context = context.WithValue(ctx.Context, ctxKeyAppInfo, info)
}

func (ctx *Context) GetUserInfo() (*UserInfo, error) {
	info, ok := ctx.Value(ctxKeyUserInfo).(*UserInfo)
	if !ok {
		return nil, v1.ErrorNotFound("UserInfo not found")
	}
	return info, nil
}

func (ctx *Context) SetUserInfo(info *UserInfo) {
	ctx.Context = context.WithValue(ctx.Context, ctxKeyUserInfo, info)
}

```
